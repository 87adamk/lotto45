<!DOCTYPE html>
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
<meta name="apple-mobile-web-app-capable" content="no" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<html>
<head>
  <% include ../partials/header.ejs %>
</head>


<script type="text/javascript" src="libs/grid.js"></script>
<script type="text/javascript" src="libs/version.js"></script>
<script type="text/javascript" src="libs/detector.js"></script>
<script type="text/javascript" src="libs/formatinf.js"></script>
<script type="text/javascript" src="libs/errorlevel.js"></script>
<script type="text/javascript" src="libs/bitmat.js"></script>
<script type="text/javascript" src="libs/datablock.js"></script>
<script type="text/javascript" src="libs/bmparser.js"></script>
<script type="text/javascript" src="libs/datamask.js"></script>
<script type="text/javascript" src="libs/rsdecoder.js"></script>
<script type="text/javascript" src="libs/gf256poly.js"></script>
<script type="text/javascript" src="libs/gf256.js"></script>
<script type="text/javascript" src="libs/decoder.js"></script>
<script type="text/javascript" src="libs/qrcode.js"></script>
<script type="text/javascript" src="libs/findpat.js"></script>
<script type="text/javascript" src="libs/alignpat.js"></script>
<script type="text/javascript" src="libs/databr.js"></script>
<!-- QR Code -->
<script type="text/javascript">
var gCtx = null;
  var gCanvas = null;

  var imageData = null;
  var ii=0;
  var jj=0;
  var c=0;
  
  
function dragenter(e) {
  e.stopPropagation();
  e.preventDefault();
}

function dragover(e) {
  e.stopPropagation();
  e.preventDefault();
}
function drop(e) {
  e.stopPropagation();
  e.preventDefault();

  var dt = e.dataTransfer;
  var files = dt.files;

  handleFiles(files);
}

function handleFiles(f)
{
  var o=[];
  for(var i =0;i<f.length;i++)
  {
    var reader = new FileReader();

      reader.onload = (function(theFile) {
        return function(e) {
          qrcode.decode(e.target.result);
        };
      })(f[i]);

      // Read in the image file as a data URL.
      reader.readAsDataURL(f[i]); }
}
  
function read(a)
{
  alert(a);
} 
  
function load()
{
  initCanvas(640,480);
  qrcode.callback = read;
  qrcode.decode("meqrthumb.png");
}

function initCanvas(ww,hh)
  {
    gCanvas = document.getElementById("qr-canvas");
    gCanvas.addEventListener("dragenter", dragenter, false);  
    gCanvas.addEventListener("dragover", dragover, false);  
    gCanvas.addEventListener("drop", drop, false);
    var w = ww;
    var h = hh;
    gCanvas.style.width = w + "px";
    gCanvas.style.height = h + "px";
    gCanvas.width = w;
    gCanvas.height = h;
    gCtx = gCanvas.getContext("2d");
    gCtx.clearRect(0, 0, w, h);
    imageData = gCtx.getImageData( 0,0,320,240);
  }

  function passLine(stringPixels) { 
    //a = (intVal >> 24) & 0xff;

    var coll = stringPixels.split("-");
  
    for(var i=0;i<320;i++) { 
      var intVal = parseInt(coll[i]);
      r = (intVal >> 16) & 0xff;
      g = (intVal >> 8) & 0xff;
      b = (intVal ) & 0xff;
      imageData.data[c+0]=r;
      imageData.data[c+1]=g;
      imageData.data[c+2]=b;
      imageData.data[c+3]=255;
      c+=4;
    } 

    if(c>=320*240*4) { 
      c=0;
            gCtx.putImageData(imageData, 0,0);
    } 
  } 

        function captureToCanvas() {
    flash = document.getElementById("embedflash");
    flash.ccCapture();
    qrcode.decode();
        }
</script>
<!-- QR Code -->

<script type="text/javascript">
  function mobileResize() {
    var myWidth = 0, myHeight = 0;

    if( typeof( window.innerWidth ) == 'number' ) {
      //Non-IE
      myWidth = window.innerWidth;
      myHeight = window.innerHeight;
    } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
      //IE 6+ in 'standards compliant mode'
      myWidth = document.documentElement.clientWidth;
      myHeight = document.documentElement.clientHeight;
    } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
      //IE 4 compatible
      myWidth = document.body.clientWidth;
      myHeight = document.body.clientHeight;
    }
   
    // div ¿¡ ½×¿©Áø ¿µ¿ª È­¸é Á¶Á¤ 
    var deviceWidth = myWidth;
    document.getElementById('main').style.width = deviceWidth + "px";
  }

  function bubbleSort(array)
  {
      var swapped;
      do {
          swapped = false;
          for (var i=0; i < array.length-1; i++) {
              if (array[i] > array[i+1]) {
                  var temp = array[i];
                  array[i] = array[i+1];
                  array[i+1] = temp;
                  swapped = true;
              }
          }
      } while (swapped);
  }

  function makeNumber() {
     // 6°³ÀÇ ·Î¶Ç ¹øÈ£¸¦ ÀúÀåÇÒ ¹è¿­
      var lotto = new Array(6);
     // ÃßÃ·µÈ ·Î¶Ç¹øÈ£ÀÇ °¹¼ö
      var count = 0;
     // ¹øÈ£Áßº¹ ¹æÁö¿ë º¯¼ö
     var mFlag = true;
     // 6°³ÀÇ ·Î¶Ç¹øÈ£¸¦ ¾òÀ»¶§±îÁö ¹Ýº¹
     while(count < 6)
     {
       var number;
       // ·£´ý¹øÈ£ ÃßÃâ
       number = parseInt(Math.random()*45)+1
       // Áßº¹È®ÀÎ
       for(var i=0; i<count; i++)
          if(lotto[i] == number) mFlag = false;
       // Áßº¹µÈ ¹øÈ£°¡ ¾Æ´Ï¸é ·Î¶Ç ¹øÈ£¹è¿­¿¡ Ãß°¡
       if(mFlag)
       {
            lotto[count] = number;
            count++;
       }
       mFlag = true;
     } 

     bubbleSort(lotto);

     for(var i=0; i<6; i++) {

        var id = "number_field_"+(i+1);
        $("#"+id).attr("src", "http://www.nlotto.co.kr/img/common/ball_"+lotto[i]+".png");
        $("#"+id).attr("alt", lotto[i]);
     }
  }
</script>
<body onload="load()">

  <div id="main">
    <div style="text-align: center; margin-top: 20px">
      <font size="100">Lotto 45</font>
    </div>
    <div style="text-align: right; margin: 20px">
      <button onclick="makeNumber();" style="width: 200px;">생성</button>
    </div>
    <div style="text-align: center;">
      <img id="number_field_1"/>
      <img id="number_field_2"/>
      <img id="number_field_3"/>
      <img id="number_field_4"/>
      <img id="number_field_5"/>
      <img id="number_field_6"/>
    </div>
  </div>

  <div id="qrSection">
    <div class="container">
    
    </div>
    <button onclick="captureToCanvas();">Capture</button><br>
    <canvas id="qr-canvas" width="640" height="480"></canvas>
  </div>
</body>
</html>
